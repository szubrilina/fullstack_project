"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var child_process_1 = require("child_process");
var fs_1 = require("fs");
var path_1 = __importDefault(require("path"));
function clearCache() {
    var npmCacheDirectory = child_process_1.execSync('npm config get cache').toString().trimRight();
    var npxCacheDirectory = path_1.default.join(npmCacheDirectory, '_npx');
    if (fs_1.existsSync(npxCacheDirectory)) {
        for (var _i = 0, _a = fs_1.readdirSync(npxCacheDirectory); _i < _a.length; _i++) {
            var subdirectoryName = _a[_i];
            var subdirectory = path_1.default.join(npxCacheDirectory, subdirectoryName);
            var packagePath = path_1.default.join(subdirectory, 'package.json');
            if (fs_1.existsSync(packagePath)) {
                var package_json = JSON.parse(fs_1.readFileSync(packagePath).toString());
                if (package_json.name === 'clear-npx-cache')
                    continue;
            }
            fs_1.rmSync(subdirectory, { recursive: true });
        }
    }
    else
        fs_1.mkdirSync(npxCacheDirectory);
}
exports.default = clearCache;
